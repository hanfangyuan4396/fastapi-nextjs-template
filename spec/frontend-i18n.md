# 前端国际化功能需求文档

## 需求描述

为前端应用添加国际化（i18n）支持，使应用能够根据用户的语言偏好显示不同语言的内容。初期支持中文和英文两种语言。

## 需求目标

1. 实现前端应用的多语言切换功能
2. 支持中文（简体）和英文两种语言
3. 实现智能的语言选择优先级机制
4. 提供良好的用户体验，语言切换流畅无需刷新页面

## 技术方案

### 技术选型
- 使用 `next-intl` 作为国际化解决方案
- 使用 Cookie 存储用户的语言偏好设置

### 语言优先级
按照以下优先级确定用户使用的语言：

1. **Cookie 中的 locale 字段**（最高优先级）
   - 用户手动选择的语言会存储在 Cookie 的 `locale` 字段
   - Cookie 过期时间：365天（1年）
   - 一旦用户手动选择，以后访问都使用该语言

2. **浏览器默认语言**（次优先级）
   - 首次访问时，如果 Cookie 中没有 locale 字段
   - 自动检测浏览器的 `Accept-Language` 头
   - 如果浏览器语言为中文（zh, zh-CN, zh-TW等），使用中文
   - 如果浏览器语言为英文（en, en-US, en-GB等），使用英文

3. **默认语言：中文**（兜底）
   - 如果以上都无法匹配，使用中文作为默认语言

### UI 设计
- 语言切换组件位置：顶部导航栏右侧
- 不在 URL 中体现语言路径（即不使用 `/en/`, `/zh/` 前缀）
- 纯通过 Cookie 控制语言切换

### 翻译文件组织
- 按功能模块拆分翻译文件（如 `common.json`, `auth.json`, `student.json` 等）
- 便于维护和按需加载

### 内容迁移策略
- 当前应用仅有两个页面，代码量较少
- 采用一次性完全迁移的方式
- 未来新增内容通过 AI 辅助直接添加翻译

### 实现范围

#### 第一阶段（核心功能）
- [ ] 配置 next-intl 基础环境
- [ ] 实现语言检测和切换机制（基于 Cookie + 浏览器语言）
- [ ] 在顶部导航栏右侧创建语言切换组件
- [ ] 按模块组织翻译文件
- [ ] 迁移现有两个页面的所有文本内容
- [ ] 配置 Cookie 存储语言偏好（过期时间：365天）

#### 第二阶段（完善）
- [ ] 添加日期、时间、数字格式化
- [ ] 优化语言切换的用户体验
- [ ] 添加语言切换动画效果

## 技术决策

### 1. 默认语言
✅ **决策**: 使用中文作为默认语言

### 2. 语言切换 UI 位置
✅ **决策**: 放置在顶部导航栏右侧

### 3. 翻译文件组织方式
✅ **决策**: 按功能模块拆分（如 `common.json`, `auth.json`, `student.json`）

### 4. URL 路径处理
✅ **决策**: 不在 URL 中体现语言，纯通过 Cookie 控制
- 优点：URL 更简洁，实现更简单
- 缺点：对 SEO 不够友好（如果未来需要 SEO 优化，可以考虑改为 URL 前缀方案）

### 5. 现有内容迁移
✅ **决策**: 一次性完全迁移
- 当前仅有两个页面，代码量较少
- 采用直接迁移的方式，无需分阶段

### 6. 翻译维护流程
✅ **决策**: 使用 AI 辅助翻译
- 未来新增内容时，直接通过 AI 工具生成对应的翻译
- 无需建立复杂的翻译审核流程

### 7. Cookie 配置
✅ **决策**:
- **过期时间**: 365天（1年）
- **字段名**: `locale`
- **作用域**: 默认（当前域名下所有路径）
- **安全选项**: 根据 Next.js 最佳实践配置

## 相关资源

- next-intl 文档: https://next-intl-docs.vercel.app/
- Next.js 国际化指南: https://nextjs.org/docs/app/building-your-application/routing/internationalization

## 注意事项

1. **SEO 考虑**: 由于不使用 URL 语言前缀，搜索引擎爬虫可能只能索引默认语言（中文）的内容。如果未来有国际化 SEO 需求，需要重新评估技术方案。

2. **服务端渲染**: 需要确保首次渲染时就能正确识别用户语言，避免语言闪烁问题。

3. **浏览器兼容性**: 确保 Cookie 读写在所有目标浏览器中正常工作。

## 更新记录

- 2025-10-30: 初始创建
- 2025-10-30: 完成需求讨论，确定所有技术决策
